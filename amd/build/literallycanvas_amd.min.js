define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/react_amd","filter_poodll/uploader","filter_poodll/literallycanvas"],function(a,b,c,d,e,f){"use strict";return b.debug("Filter PoodLL: literallycanvas.js initialising"),{loadliterallycanvas:function(b){var d="#amdopts_"+b.recorderid,g=a(d).get(0);g&&(b=JSON.parse(g.value),a(d).remove()),c.whiteboardopts[b.recorderid]=b;var h="#"+b.recorderid+"_literally",i=a("#"+h)[0];if(e.init(h,b),b.backgroundimage){var j=a("#"+b.recorderid+"_separate-background-image")[0],k=new Image;k.src=j.src,k.crossOrigin="Anonymous";var l=f.createShape("Image",{x:0,y:0,image:k,scale:1}),m=f.init(i,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,backgroundShapes:[l],recorderid:b.recorderid})}else var m=f.init(i,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,recorderid:b.recorderid});var n=c.whiteboardopts[b.recorderid].vectordata;n&&(0==n.indexOf('{"shapes"')||0==n.indexOf('{"colors"'))&&m.loadSnapshot(JSON.parse(n)),b.autosave?m.on("drawingChange",function(b,d){return function(){var b=a("#"+d+"_messages")[0],e=a("#"+d+"_btn_upload_whiteboard")[0];if(b){e&&(e.disabled=!1),b.innerHTML="";var f=c.timeouthandles[d];f&&clearTimeout(f),c.timeouthandles[d]=setTimeout(function(){c.WhiteboardUploadHandler(d)},c.whiteboardopts[d].autosave)}}}(this,b.recorderid)):m.on("drawingChange",function(b,c){return function(){var b=a("#"+c+"_messages");b&&(b.innerHTML="File has not been saved.")}}(this,b.recorderid)),c.whiteboards[b.recorderid]=m;var o="#"+b.recorderid+"_btn_upload_whiteboard",p=a(o);p&&(b.autosave?p.click(function(){c.WhiteboardUploadHandler(b.recorderid)},!1):p.click(function(){c.CallFileUpload(b.recorderid)},!1))}}});