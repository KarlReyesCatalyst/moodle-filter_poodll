{"version":3,"sources":["../src/msr_poodll.js"],"names":["define","$","log","utils","stereoaudiorecorder","plainrecorder","debug","sampleRate","mimeType","audioChannels","bufferSize","therecorder","audioctx","audioanalyser","state","clone","extend","init","mediaStream","mediaType","encoder","has_mediarecorder","start","timeinterval","stop","clear","pause","resume","ondataavailable","blob","onStartedDrawingNonBlankFrames","onstop","error"],"mappings":"AACAA,OAAM,4BAAC,CAAC,QAAD,CACC,UADD,CACa,yBADb,CACwC,+BADxC,CACyE,yBADzE,CAAD,CAEF,SAAUC,CAAV,CAAaC,CAAb,CAAkBC,CAAlB,CAAyBC,CAAzB,CAA8CC,CAA9C,CAA6D,CAEzD,aAEAH,CAAG,CAACI,KAAJ,CAAU,kCAAV,EAEA,MAAO,CAEHC,UAAU,CAAE,IAFT,CAGHC,QAAQ,CAAE,WAHP,CAIHC,aAAa,CAAE,CAJZ,CAKHC,UAAU,CAAE,IALT,CAMHC,WAAW,CAAE,IANV,CAOHC,QAAQ,CAAE,IAPP,CAQHC,aAAa,CAAE,IARZ,CASHC,KAAK,CAAE,SATJ,CAYHC,KAAK,CAAE,gBAAY,CACf,MAAOd,CAAAA,CAAC,CAACe,MAAF,IAAe,EAAf,CAAmB,IAAnB,CACV,CAdE,CAkBHC,IAAI,CAAE,cAAUC,CAAV,CAAuBN,CAAvB,CAAiCC,CAAjC,CAAgDM,CAAhD,CAA2DC,CAA3D,CAAoE,CAGtE,KAAKR,QAAL,CAAgBA,CAAhB,CACA,KAAKC,aAAL,CAAqBA,CAArB,CAGA,GAAe,MAAX,EAAAO,CAAJ,CAAuB,CACnB,OAAQA,CAAR,EACI,IAAK,aAAL,CACI,GAAiB,OAAb,EAAAD,CAAJ,CAA0B,CACtB,KAAKR,WAAL,CAAmBP,CACtB,CAFD,IAEO,CACH,KAAKO,WAAL,CAAmBN,CACtB,CACD,MACJ,IAAK,OAAL,CACA,QACI,KAAKM,WAAL,CAAmBN,CAAnB,CAVR,CAaH,CAdD,IAcO,IAAIF,CAAK,CAACkB,iBAAN,EAAJ,CAA+B,CAClC,KAAKV,WAAL,CAAmBN,CAAnB,CACAH,CAAG,CAACI,KAAJ,CAAU,sBAAV,CAGH,CALM,IAKA,IAAiB,OAAb,EAAAa,CAAJ,CAA0B,CACzB,KAAKR,WAAL,CAAmBP,CAAnB,CACAF,CAAG,CAACI,KAAJ,CAAU,uBAAV,CAGP,CACD,GAAI,KAAKK,WAAT,CAAsB,CAClB,KAAKA,WAAL,CAAiBM,IAAjB,CAAsB,IAAtB,CAA4BC,CAA5B,CAAyCN,CAAzC,CAAmDO,CAAnD,CACH,CAEJ,CAtDE,CAwDHG,KAAK,CAAE,eAAUC,CAAV,CAAwB,CAC3B,KAAKZ,WAAL,CAAiBW,KAAjB,CAAuBC,CAAvB,EAEA,KAAKV,aAAL,CAAmBS,KAAnB,GACA,KAAKR,KAAL,CAAW,SACd,CA7DE,CA+DHU,IAAI,CAAE,eAAY,CACd,KAAKb,WAAL,CAAiBa,IAAjB,GACA,KAAKX,aAAL,CAAmBY,KAAnB,GACA,KAAKX,KAAL,CAAW,SACd,CAnEE,CAqEHY,KAAK,CAAE,gBAAY,CACf,KAAKf,WAAL,CAAiBe,KAAjB,GACA,KAAKb,aAAL,CAAmBY,KAAnB,GACA,KAAKX,KAAL,CAAW,SACd,CAzEE,CA2EHa,MAAM,CAAE,iBAAY,CAChB,KAAKhB,WAAL,CAAiBgB,MAAjB,GACA,KAAKd,aAAL,CAAmBS,KAAnB,GACA,KAAKR,KAAL,CAAW,SACd,CA/EE,CAiFHc,eAAe,CAAE,yBAAUC,CAAV,CAAgB,CAC7B3B,CAAG,CAACI,KAAJ,CAAU,mBAAqBuB,CAA/B,CACH,CAnFE,CAqFHC,8BAA8B,CAAE,yCAAY,CACxC5B,CAAG,CAACI,KAAJ,CAAU,mCAAV,CACH,CAvFE,CAyFHyB,MAAM,CAAE,gBAAUC,CAAV,CAAiB,CACrB9B,CAAG,CAACI,KAAJ,CAAU0B,CAAV,CACH,CA3FE,CA6FV,CArGC,CAAN","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery',\n        'core/log', 'filter_poodll/utils_amd', 'filter_poodll/msr_stereoaudio', 'filter_poodll/msr_plain'],\n    function ($, log, utils, stereoaudiorecorder, plainrecorder) {\n\n        \"use strict\"; // jshint ;_;\n\n        log.debug('PoodLL MS Recorder: initialising');\n\n        return {\n\n            sampleRate: 48000,//44100,\n            mimeType: 'audio/wav',\n            audioChannels: 1,\n            bufferSize: 2048,\n            therecorder: null,\n            audioctx: null,\n            audioanalyser: null,\n            state: 'stopped',\n\n            //for making multiple instances\n            clone: function () {\n                return $.extend(true, {}, this);\n            },\n\n            // init the poodll recorder\n            // basically we check the users preferred recorders and if the rec supports the browser\n            init: function (mediaStream, audioctx, audioanalyser, mediaType, encoder) {\n                //we want to use the same context for absolutely everything\n                //so we pass it around. analyser should be available to skins but we set it up here\n                this.audioctx = audioctx;\n                this.audioanalyser = audioanalyser;\n\n                //this is where we choose which recorder/encoder set we will use\n                if (encoder != 'auto') {\n                    switch (encoder) {\n                        case 'stereoaudio':\n                            if (mediaType == 'audio') {\n                                this.therecorder = stereoaudiorecorder;\n                            } else {\n                                this.therecorder = plainrecorder;\n                            }\n                            break;\n                        case 'plain':\n                        default:\n                            this.therecorder = plainrecorder;\n                    }\n                    //if browser has mediarecorder, lets use it!\n                } else if (utils.has_mediarecorder()) {\n                    this.therecorder = plainrecorder;\n                    log.debug('using plain recorder');\n\n                 //we can handle audio using wav encoder, so even without mediarecorder we are ok\n                } else if (mediaType == 'audio') {\n                        this.therecorder = stereoaudiorecorder;\n                        log.debug('using stereo recorder');\n                        //before init is called, set mimeType/sampleRate/audioChannels\n                        //etc on this object, they will be picked up when stereoaudiorecorder helper runs\n                }\n                if (this.therecorder) {\n                    this.therecorder.init(this, mediaStream, audioctx, mediaType);\n                }\n\n            },\n\n            start: function (timeinterval) {\n                this.therecorder.start(timeinterval);\n                //start audio analyser which generates events for wav/freq visualisations\n                this.audioanalyser.start();\n                this.state='started';\n            },\n\n            stop: function () {\n                this.therecorder.stop();\n                this.audioanalyser.clear();\n                this.state='stopped';\n            },\n\n            pause: function () {\n                this.therecorder.pause();\n                this.audioanalyser.clear();\n                this.state='stopped';\n            },\n\n            resume: function () {\n                this.therecorder.resume();\n                this.audioanalyser.start();\n                this.state='started';\n            },\n\n            ondataavailable: function (blob) {\n                log.debug('ondataavailable:' + blob);\n            },\n\n            onStartedDrawingNonBlankFrames: function () {\n                log.debug('started drawing non blank frames:');\n            },\n\n            onstop: function (error) {\n                log.debug(error);\n            }\n        };// end of returned object\n    });// total end\n"],"file":"msr_poodll.min.js"}