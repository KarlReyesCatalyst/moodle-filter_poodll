define(["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";return b.debug("PoodLL Flash Recorder: initialising"),{savebutton:null,audiodatacontrol:null,supports_current_browser:function(a){var c=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;return c?!1:"video"==a.mediatype?!1:(b.debug("PoodLL Flash Recorder: supports this browser"),!0)},embed:function(b,d){var e=a.parseJSON(d.flashmp3audio_widgetjson);lz.embed.swf(e);var f=d.widgetid+"_savebutton",g='<button id="'+f+'" class="poodll_save-recording">'+M.util.get_string("recui_save","filter_poodll")+"</button>";a(b).append(g);var h=d.widgetid+"_audiodatacontrol",i='<input type="hidden" id="'+h+'"/>';a(b).prepend(i),c.init(b,d),lz.embed[d.widgetid].setCanvasAttribute("audiodatacontrol",h),this.savebutton=a("#"+f),this.audiodatacontrol=a("#"+h),this.registerevents()},registerevents:function(){var a=this;this.savebutton.click(function(){for(var b=atob(a.audiodatacontrol.val()),d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));var f=new Blob([new Uint8Array(d)],{type:"audio/mpeg3"});c.uploadBlob(f,"audio/mpeg3")})}}});