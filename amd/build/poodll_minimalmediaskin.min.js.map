{"version":3,"sources":["../src/poodll_minimalmediaskin.js"],"names":["define","$","log","utils","upskin","speechrecognition","settings","audioplayer_minimal","debug","instanceprops","pmr","devsettings","currentvisualmode","clone","extend","init","ip","fetch_instanceprops","onUploadSuccess","controlbarid","set_visual_mode","onUploadFailure","fetch_status_bar","skin","fetch_preview_audio","fetch_preview_video","fetch_resource_audio","fetch_resource_video","fetch_uploader_skin","element","theupskin","config","controlbar","uploadbutton","onMediaError","e","console","error","onMediaSuccess_video","onMediaSuccess_audio","preview","attr","uploader","Output","stopbutton","addClass","timer","reset","start","update_status","handle_timer_update","status","html","fetch_display_time","seconds","initseconds","click","timelimit","data","mode","self","enable_button","startbutton","disable_button","playbutton","restartbutton","playback","hide","show","blobs","length","doConcatenateBlobs","concatenatedBlob","mediaurl","URL","createObjectURL","removeAttr","src","load","insert_controlbar_video","resource","prepare_controlbar","insert_controlbar_audio","mediatype","skin_style","media_skin_style","recorder_class","size","ss","fetch_strings","controls","fetch_dialogue_box","downloaddialog","errordialog","prepend","settingsdialog","errorsdialog","settingsicon","stopplayingbutton","set_dialogue_box","register_controlbar_events_video","onMediaSuccess","register_controlbar_events_audio","uploaded","open","do_start_audio","do_stop_audio","removeClass","stop","doDeferredUpload","do_save_audio","setTimeout","window","onbeforeunload","button"],"mappings":"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","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery',  'core/log', 'filter_poodll/utils_amd', 'filter_poodll/upskin_cssradial',\n    'filter_poodll/speech_poodll', 'filter_poodll/dlg_devicesettings', 'filter_poodll/audioplayer_minimal'],\n    function ($, log, utils, upskin, speechrecognition, settings,audioplayer_minimal) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('PoodLL Minimal Skin: initialising');\n\n    return {\n\n        instanceprops: null,\n        pmr: null,\n        devsettings: null,\n        currentvisualmode: '',\n\n\n        //for making multiple instances\n        clone: function () {\n            return $.extend(true, {}, this);\n        },\n\n        init: function (ip, pmr) {\n            this.instanceprops = ip;\n            this.pmr = pmr;\n            this.devsettings = settings.clone();\n            this.devsettings.init(pmr, ip);\n        },\n\n\n        fetch_instanceprops: function () {\n            return this.instanceprops;\n        },\n\n\n        onUploadSuccess: function (controlbarid) {\n            //playback mode\n            this.set_visual_mode('playbackmode', controlbarid);\n            log.debug('now playback mode');\n        },\n\n        onUploadFailure: function (controlbarid) {\n            return;\n        },\n\n        fetch_status_bar: function (skin) {\n            var status = '<div class=\"poodll_status_' + skin + '\" width=\"320\" height=\"50\">00:00:00</div>';\n            return status;\n        },\n\n        fetch_preview_audio: function (skin) {\n            var preview = '<audio class=\"poodll_preview_' + skin + ' hide\" playsinline=\"playsinline\" ></audio>';\n            return preview;\n        },\n        fetch_preview_video: function (skin) {\n            var preview = '<video class=\"poodll_preview_' + skin + '\" width=\"320\" height=\"240\" playsinline=\"playsinline\" muted></video>';\n            return preview;\n        },\n        fetch_resource_audio: function (skin) {\n            var resourceplayer = '<audio class=\"poodll_resourceplayer_' + skin + ' hide\" playsinline=\"playsinline\"></audio>';\n            return resourceplayer;\n        },\n        fetch_resource_video: function (skin) {\n            var resourceplayer = '<video class=\"poodll_resourceplayer_' + skin + ' hide\" playsinline=\"playsinline\"></video>';\n            return resourceplayer;\n        },\n\n        fetch_uploader_skin: function (controlbarid, element) {\n            var ip = this.fetch_instanceprops();\n            var theupskin = upskin.clone();\n            theupskin.init(ip.config, element, ip.controlbar.uploadbutton);\n            return theupskin;\n        },\n\n        onMediaError: function (e) {\n            console.error('media error', e);\n        },\n\n        onMediaSuccess_video: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            this.set_visual_mode('recordingmode', controlbarid);\n        },\n\n        onMediaSuccess_audio: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.preview.attr('src', null);\n\n            //clear messages\n            ip.uploader.Output('');\n\n            //wave animation\n            ip.controlbar.stopbutton.addClass('animation_running');\n\n            //timer and status bar\n            ip.timer.reset();\n            ip.timer.start();\n            this.update_status(controlbarid);\n\n            //visuals\n            this.set_visual_mode('recordingmode', controlbarid);\n        },\n\n        handle_timer_update: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.status.html(ip.timer.fetch_display_time());\n            if (ip.timer.seconds == 0 && ip.timer.initseconds > 0) {\n                ip.controlbar.stopbutton.click();\n            }\n        },\n\n        update_status: function (controlbarid) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            ip.controlbar.status.html(ip.timer.fetch_display_time());\n            if(ip.config.timelimit > 0){\n                ip.controlbar.preview.data('duration', ip.config.timelimit - ip.timer.seconds);\n            }else {\n                ip.controlbar.preview.data('duration', ip.timer.seconds);\n            }\n        },\n\n        //set visuals for different states (ie recording or playing)\n        set_visual_mode: function (mode, controlbarid) {\n            var self = this;\n            var ip = this.fetch_instanceprops(controlbarid);\n\n\n            switch (mode) {\n\n                case 'startmode':\n                    self.enable_button(ip.controlbar.status);\n                    self.enable_button(ip.controlbar.startbutton);\n                    self.disable_button(ip.controlbar.playbutton);\n                    self.disable_button(ip.controlbar.stopbutton);\n                    self.disable_button(ip.controlbar.restartbutton);\n                    self.disable_button(ip.controlbar.uploadbutton);\n                    ip.controlbar.playback.hide();\n                    break;\n\n\n                case 'recordingmode':\n                    self.enable_button(ip.controlbar.status);\n                    self.enable_button(ip.controlbar.stopbutton);\n                    self.disable_button(ip.controlbar.startbutton);\n                    self.disable_button(ip.controlbar.playbutton);\n                    self.disable_button(ip.controlbar.restartbutton);\n                    self.disable_button(ip.controlbar.uploadbutton);\n                    ip.controlbar.playback.hide();\n\n                    break;\n\n                case 'uploadmode':\n                    self.enable_button(ip.controlbar.status);\n                    self.enable_button(ip.controlbar.uploadbutton);\n                    self.disable_button(ip.controlbar.stopbutton);\n                    self.disable_button(ip.controlbar.startbutton);\n                    self.disable_button(ip.controlbar.playbutton);\n                    self.disable_button(ip.controlbar.restartbutton);\n                    ip.controlbar.playback.hide();\n\n                    break;\n\n                case 'playbackmode':\n                    self.disable_button(ip.controlbar.status);\n                    self.disable_button(ip.controlbar.uploadbutton);\n                    self.disable_button(ip.controlbar.stopbutton);\n                    self.disable_button(ip.controlbar.startbutton);\n                    self.disable_button(ip.controlbar.playbutton);\n                    self.enable_button(ip.controlbar.restartbutton);\n                    ip.controlbar.playback.show();\n                    if (ip.blobs && ip.blobs.length > 0) {\n                        utils.doConcatenateBlobs(ip.blobs, function (concatenatedBlob) {\n                            var mediaurl = URL.createObjectURL(concatenatedBlob);\n                            ip.controlbar.preview.removeAttr('src');\n                            ip.controlbar.preview[0].src = mediaurl;\n                            ip.controlbar.preview[0].load();\n                        });\n                    }\n                    break;\n\n                case 'playingmode':\n\n                    self.disable_button(ip.controlbar.status);\n                    self.disable_button(ip.controlbar.stopbutton);\n                    self.disable_button(ip.controlbar.startbutton);\n                    self.disable_button(ip.controlbar.playbutton);\n                    self.disable_button(ip.controlbar.restartbutton);\n                    self.disable_button(ip.controlbar.uploadbutton);\n                    ip.controlbar.playback.show();\n                    break;\n            }\n            self.currentvisualmode = mode;\n\n        },\n\n        //insert the control bar and return it to be reused\n        insert_controlbar_video: function (element, controlbarid, preview, resource) {\n            var controlbar = this.prepare_controlbar(element, controlbarid, preview, resource, 'video');\n            return controlbar;\n        },\n\n        //insert the control bar and return it to be reused\n        insert_controlbar_audio: function (element, controlbarid, preview, resource) {\n            var controlbar = this.prepare_controlbar(element, controlbarid, preview, resource, 'audio');\n            return controlbar;\n        },\n\n        //insert the control bar and return it to be reused\n        prepare_controlbar: function (element, controlbarid, preview, resource, mediatype) {\n            var ip = this.fetch_instanceprops(controlbarid);\n            var skin_style = ip.config.media_skin_style;\n\n            var recorder_class = mediatype === 'video' ? 'poodll_mediarecorder_video' : 'poodll_mediarecorder_audio';\n\n            var size_class = 'poodll_mediarecorder_size_auto';\n            switch (ip.config.size) {\n                case 'small':\n                    size_class = 'poodll_mediarecorder_size_small';\n                    break;\n                case 'big':\n                    size_class = 'poodll_mediarecorder_size_big';\n                    break;\n                case 'auto':\n                    size_class = 'poodll_mediarecorder_size_auto';\n            }\n\n            var ss = this.pmr.fetch_strings();\n\n            var controls = '<div class=\"poodll_mediarecorderholder_minimal '\n                + recorder_class + '\" id=\"holder_' + controlbarid + '\">';\n\n            controls += '<div class=\"poodll_mediarecorderbox_minimal\" id=\"' + controlbarid + '\">';\n            controls += this.devsettings.fetch_dialogue_box();\n            controls += ip.downloaddialog.fetch_dialogue_box();\n            controls += ip.errordialog.fetch_dialogue_box();\n            controls += '<div class=\"style-holder ' + skin_style + '\">';\n            var status = this.fetch_status_bar('minimal');\n            controls += status;\n            controls += preview;\n            controls += '<div class=\"settingsicon\" id=\"settingsicon_' + controlbarid + '\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>';\n            controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_minimal poodll_mediarecorder_minimal_start_button\"></button>';\n            controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_minimal poodll_mediarecorder_minimal_stop_button\"></button>';\n            controls += ' <button type=\"button\" class=\"poodll_mediarecorder_button_minimal poodll_mediarecorder_minimal_upload_button\"></button>';\n            controls += ' <button type=\"button\" class=\"poodll_mediarecorder_button_minimal poodll_mediarecorder_minimal_play_button\"><i class=\"fa fa-play\" aria-hidden=\"true\"></i></button>';\n            controls += ' <div class=\"poodll_playback_minimal\"></div>';\n            controls += '<div class=\"minimal-restart-button-wrapper\"><a class=\"poodll_restart_minimal \" ><i class=\"fa fa-repeat fa-flip-horizontal\" aria-hidden=\"true\"></i></a></div>';\n            controls += '</div></div></div>';\n\n            $(element).prepend(controls);\n            var controlbar = {\n                settingsdialog: $('#' + controlbarid + ' .poodll_dialogue_box_settings'),\n                downloaddialog: $('#' + controlbarid + ' .poodll_dialogue_box_download'),\n                errorsdialog: $('#' + controlbarid + ' .poodll_dialogue_box_errors'),\n                settingsicon: $('#' + controlbarid + ' .settingsicon'),\n                status: $('#' + controlbarid + ' .poodll_status_minimal'),\n                preview: $('#' + controlbarid + ' .poodll_preview_minimal'),\n                playback: $('#' + controlbarid + ' .poodll_playback_minimal'),\n                startbutton: $('#' + controlbarid + ' .poodll_mediarecorder_minimal_start_button'),\n                stopbutton: $('#' + controlbarid + ' .poodll_mediarecorder_minimal_stop_button'),\n                stopplayingbutton: $('#' + controlbarid + ' .poodll_stop-playing_minimal'),\n                uploadbutton: $('#' + controlbarid + ' .poodll_mediarecorder_minimal_upload_button'),\n                playbutton: $('#' + controlbarid + ' .poodll_mediarecorder_minimal_play_button'),\n                restartbutton: $('#' + controlbarid + ' .poodll_restart_minimal')\n            };\n            //settings and error and download dialogs\n            //settings is on 'this' because it is shown from skkn events, but errors are from pmr stuff\n            ip.downloaddialog.set_dialogue_box(controlbar.downloaddialog);\n            ip.errordialog.set_dialogue_box(controlbar.errorsdialog);\n            this.devsettings.set_dialogue_box(controlbar.settingsdialog);\n\n            //set up audio player\n            var opts ={'player_element': '#' + controlbarid + ' .poodll_preview_minimal', 'autoid': controlbarid};\n            var playerhtml='<div id=\"' + controlbarid + '_fpminimal_audioplayer\" class=\"fpminimal_audioplayer\">\\n' +\n                '    <button type=\"button\" class=\"fpminimal_audioplayer_play_button\"></button>\\n' +\n                '    <div class=\"fpminimal_audioplayer_skip_buttons\">\\n' +\n                '        <button type=\"button\" class=\"fpminimal_audioplayer_skip_button_back\">15</button>\\n' +\n                '        <button type=\"button\" class=\"fpminimal_audioplayer_skip_button_forward\">15</button>\\n' +\n                '    </div>\\n' +\n                '    <div class=\"fpminimal_audioplayer_bar\">\\n' +\n                '        <div class=\"fpminimal_audioplayer_bar_behind\"></div>\\n' +\n                '        <div class=\"fpminimal_audioplayer_bar_front\"></div>\\n' +\n                '    </div>\\n' +\n                '    <div class=\"fpminimal_audioplayer_time\">00:45</div>\\n' +\n                '</div>';\n            $('#' + controlbarid + ' .poodll_playback_minimal').html(playerhtml);\n            audioplayer_minimal.init(opts);\n\n            return controlbar;\n        }, //end of fetch_control_bar_minimal\n\n\n        register_controlbar_events_video: function (onMediaSuccess, controlbarid) {\n            return this.register_controlbar_events_audio(onMediaSuccess, controlbarid);\n        },\n\n        register_controlbar_events_audio: function (onMediaSuccess, controlbarid) {\n\n            var self = this;\n            var pmr = this.pmr;\n            var ip = this.fetch_instanceprops(controlbarid);\n\n            //set visual mode\n            this.set_visual_mode('startmode', controlbarid);\n\n            //recording animation, initially marked up  but not started\n            ip.controlbar.stopbutton.addClass('poodll_mediarecorder_minimal_animation');\n\n\n            ip.controlbar.settingsicon.click(function () {\n                if (!self.uploaded) {\n                    self.devsettings.open();\n                } else {\n                    ip.downloaddialog.open();\n                }\n            });\n\n\n            //Start button click\n            ip.controlbar.startbutton.click(function () {\n                pmr.do_start_audio(ip, onMediaSuccess);\n                log.debug('starting audio recording');\n\n            });\n\n            //Restart link clicked\n            ip.controlbar.restartbutton.click(function () {\n                //visuals\n                self.set_visual_mode('startmode', controlbarid);\n                ip.timer.reset();\n                self.update_status(controlbarid);\n            });\n\n            //Stop button click\n            ip.controlbar.stopbutton.click(function () {\n\n                if(self.currentvisualmode==='playbackmode'){\n                    return;\n                }\n\n                //stop recording\n                pmr.do_stop_audio(ip);\n                log.debug('stopping audio recording');\n\n                //stop previewing (if that is what we are doing)\n                /*\n                var preview = ip.controlbar.preview.get(0);\n                preview.pause();\n                */\n\n                //wave animation\n                ip.controlbar.stopbutton.removeClass('animation_running');\n\n                //timer and status bar\n                ip.timer.stop();\n                self.update_status(controlbarid);\n\n\n                //call upload right away\n                self.set_visual_mode('uploadmode', controlbarid);\n                log.debug('now uploading mode');\n                //but we have to do it this lame deferred way because some mediastreamrecorders return a single\n                //blob shortly after we stop. We init like that too, to make sure we do not truncate a users recording\n                //if the mini blobs did not arrive\n                var doDeferredUpload = function () {\n                    if (ip.blobs && ip.blobs.length > 0) {\n                        pmr.do_save_audio(ip);\n                        ip.uploaded = true;\n                        self.disable_button(ip.controlbar.startbutton);\n                    } else {\n                        setTimeout(doDeferredUpload, 200);\n                    }\n                }\n                setTimeout(doDeferredUpload, 200);\n\n            });\n\n            //Play button click\n            /*\n            ip.controlbar.playbutton.click(function () {\n\n                //commence playback\n                var preview = ip.controlbar.preview.get(0);\n                pmr.do_play_audio(ip, preview);\n\n                //init and run radial progress animation\n                rprogress.clear();\n                rprogress.fetchCurrent = function () {\n                    var ct = ip.controlbar.preview.prop('currentTime');\n                    var duration = ip.controlbar.preview.prop('duration');\n                    if (!isFinite(duration)) {\n                        duration = ip.timer.finalseconds;\n                    }\n                    return ct / duration;\n                };\n                rprogress.start();\n\n                //set visuals\n                self.set_visual_mode('playingmode', controlbarid);\n\n            });\n            */\n\n\n\n\n            //Save audio\n            var saveaudio= function () {\n\n                if (ip.blobs && ip.blobs.length > 0) {\n                    pmr.do_save_audio(ip);\n                    ip.uploaded = true;\n                } else {\n                    ip.uploader.Output(M.util.get_string('recui_nothingtosaveerror', 'filter_poodll'));\n                }//end of if self.blobs\n            }\n\n            window.onbeforeunload = function () {\n                self.enable_button(ip.controlbar.startbutton);\n\n            };\n        }, //end of register_control_bar_events_minimal\n\n        enable_button: function (button) {\n            $(button).attr('disabled', false);\n            $(button).removeClass('pmr_disabled');\n            $(button).show();\n        },\n        disable_button: function (button) {\n            $(button).attr('disabled', true);\n            $(button).addClass('pmr_disabled');\n            $(button).hide();\n        },\n\n\n\n    };//end of returned object\n});//total end\n"],"file":"poodll_minimalmediaskin.min.js"}