{"version":3,"sources":["../src/poodll_oncemediaskin.js"],"names":["define","$","log","utils","upskin_radial","hwave","settings","debug","instanceprops","pmr","devsettings","therecanim","clone","extend","init","ip","fetch_instanceprops","onUploadSuccess","controlbarid","hide","show","onUploadFailure","fetch_status_bar","skinname","fetch_preview_audio","fetch_preview_video","fetch_resource_audio","fetch_resource_video","onMediaError","e","console","error","onMediaSuccess_video","uploader","Output","timer","reset","start","update_status","set_visual_mode","onMediaSuccess_audio","controlbar","preview","attr","handle_timer_update","displaytime","fetch_display_time","seconds","initseconds","stopbutton","click","status","html","fetch_uploader_skin","element","upskin","config","uploadcanvas","uploadmessages","setDrawParam","mode","self","enable_button","startbutton","settingsicon","disable_button","finishedbutton","clear","mediatype","playcanvas","insert_controlbar_video","resource","prepare_controlbar","insert_controlbar_audio","skin_style","media_skin_style","recorder_class","ss","fetch_strings","ss_startlabel","ss_testlabel","ss_stoplabel","controls","fetch_dialogue_box","downloaddialog","errordialog","prepend","settingsdialog","errorsdialog","set_dialogue_box","register_controlbar_events_video","onMediaSuccess","register_controlbar_events_audio","recanim","audioanalyser","get","uploaded","open","hermes","enable","do_start_audio","do_stop_audio","stop","doDeferredUpload","blobs","length","do_save_audio","setTimeout","window","onbeforeunload","button","removeClass","addClass"],"mappings":"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","sourcesContent":["/* jshint ignore:start */\ndefine(['jquery','core/log', 'filter_poodll/utils_amd', 'filter_poodll/upskin_radial',\n        'filter_poodll/anim_hwave_mic', 'filter_poodll/dlg_devicesettings'],\n    function ($, log, utils, upskin_radial, hwave, settings) {\n\n        \"use strict\"; // jshint ;_;\n\n        log.debug('PoodLL Once Recorder Skin: initialising');\n\n        return {\n\n            instanceprops: null,\n            pmr: null,\n            devsettings: null,\n            therecanim: null,\n\n            //for making multiple instances\n            clone: function () {\n                return $.extend(true, {}, this);\n            },\n\n            init: function (ip, pmr) {\n                this.instanceprops = ip;\n                this.pmr = pmr;\n                this.devsettings = settings.clone();\n                this.devsettings.init(pmr, ip);\n            },\n\n\n            fetch_instanceprops: function () {\n                return this.instanceprops;\n            },\n\n\n            onUploadSuccess: function (controlbarid) {\n                $('#' + controlbarid + ' > .poodll_save-recording').hide();\n                $('#' + controlbarid + ' > .poodll_savedsuccessfully').show();\n            },\n\n            onUploadFailure: function (controlbarid) {\n                return;\n            },\n\n            fetch_status_bar: function (skinname) {\n                var status = '<div class=\"poodll_status_' + skinname + '\" width=\"320\" height=\"50\">00:00:00</div>';\n                return status;\n            },\n\n            fetch_preview_audio: function (skinname) {\n                var preview = '<audio class=\"poodll_preview_' + skinname + '\" style=\"display: none;\" playsinline=\"playsinline\" muted></audio>';\n                return preview;\n            },\n            fetch_preview_video: function (skinname) {\n                var preview = '<video class=\"poodll_preview_' + skinname + '\" style=\"display: none;\" playsinline=\"playsinline\" muted></video>';\n                return preview;\n            },\n            fetch_resource_audio: function (skinname) {\n                var resourceplayer = '<audio class=\"poodll_resourceplayer_' + skinname + '\" style=\"display: none;\" playsinline=\"playsinline\"></audio>';\n                return resourceplayer;\n            },\n            fetch_resource_video: function (skinname) {\n                var resourceplayer = '<video class=\"poodll_resourceplayer_' + skinname + '\" style=\"display: none;\" playsinline=\"playsinline\"></video>';\n                return resourceplayer;\n            },\n\n            onMediaError: function (e) {\n                console.error('media error', e);\n            },\n\n            onMediaSuccess_video: function (controlbarid) {\n                var ip = this.fetch_instanceprops();\n\n                //clear messages\n                ip.uploader.Output('');\n\n                //timer and status bar\n                ip.timer.reset();\n                ip.timer.start();\n                this.update_status(controlbarid);\n\n                this.set_visual_mode('recordingmode', controlbarid);\n            },\n\n            onMediaSuccess_audio: function (controlbarid) {\n                var ip = this.fetch_instanceprops();\n                ip.controlbar.preview.attr('src', null);\n\n                //clear messages\n                ip.uploader.Output('');\n\n                //wave animation\n                this.therecanim.start();\n\n                //timer and status bar\n                ip.timer.reset();\n                ip.timer.start();\n                this.update_status(controlbarid);\n\n                //visuals\n                this.set_visual_mode('recordingmode', controlbarid);\n            },\n\n            handle_timer_update: function (controlbarid) {\n                var ip = this.fetch_instanceprops();\n                this.therecanim.displaytime = ip.timer.fetch_display_time();\n                this.update_status(controlbarid);\n                if (ip.timer.seconds == 0 && ip.timer.initseconds > 0) {\n                    ip.controlbar.stopbutton.click();\n                }\n            },\n\n            update_status: function (controlbarid) {\n                var ip = this.fetch_instanceprops();\n                ip.controlbar.status.html(ip.timer.fetch_display_time());\n            },\n\n            fetch_uploader_skin: function (controlbarid, element) {\n                var ip = this.fetch_instanceprops();\n                var upskin = upskin_radial.clone();\n                upskin.init(ip.config, element, ip.controlbar.uploadcanvas, ip.controlbar.uploadmessages);\n                upskin.setDrawParam('lineWidth', 2);\n                upskin.setDrawParam('font', '14px Arial');\n                return upskin;\n            },\n\n            //set visuals for different states (ie recording or playing)\n            set_visual_mode: function (mode, controlbarid) {\n                var self = this;\n                var ip = this.fetch_instanceprops();\n\n                switch (mode) {\n\n                    case 'readymode':\n\n                        ip.controlbar.status.show();\n                        self.enable_button(ip.controlbar.startbutton);\n                        self.enable_button(ip.controlbar.settingsicon);\n                        self.disable_button(ip.controlbar.finishedbutton);\n                        self.disable_button(ip.controlbar.stopbutton);\n                        ip.controlbar.uploadcanvas.hide();\n                        self.therecanim.setDrawParam('wavColor', '#CCCCCC');\n                        self.therecanim.clear();\n                        if (ip.config.mediatype == 'video') {\n                            ip.controlbar.playcanvas.hide();\n                            ip.controlbar.preview.show();\n                        } else {\n                            ip.controlbar.playcanvas.show();\n                            ip.controlbar.preview.hide();\n                        }\n                        break;\n\n                    case 'recordingmode':\n                        //when testing(timer off) we do not want the stop button. Just really recording and allowearlyexit\n                        self.enable_button(ip.controlbar.stopbutton);\n                        self.disable_button(ip.controlbar.startbutton);\n                        self.disable_button(ip.controlbar.settingsicon);\n\n                        if (ip.config.mediatype == 'video') {\n                            ip.controlbar.playcanvas.hide();\n                            ip.controlbar.preview.show();\n                        } else {\n                            ip.controlbar.playcanvas.show();\n                            ip.controlbar.preview.hide();\n                        }\n\n                        ip.controlbar.uploadcanvas.hide();\n                        self.therecanim.setDrawParam('wavColor', '#FF0000');\n                        self.therecanim.clear();\n                        ip.controlbar.status.show();\n                        break;\n\n                    case 'aftermode':\n                        self.disable_button(ip.controlbar.startbutton);\n                        self.disable_button(ip.controlbar.stopbutton);\n                        self.enable_button(ip.controlbar.settingsicon);\n                        self.therecanim.setDrawParam('wavColor', '#CCCCCC');\n                        self.therecanim.clear();\n                        ip.controlbar.playcanvas.hide();\n                        if (ip.config.mediatype == 'video') {\n                            ip.controlbar.preview.hide();\n                        }\n                        ip.controlbar.uploadcanvas.show();\n                        ip.controlbar.status.show();\n\n                        break;\n\n                }\n\n            },\n\n            //insert the control bar and return it to be reused\n            insert_controlbar_video: function (element, controlbarid, preview, resource) {\n                var controlbar = this.prepare_controlbar(element, controlbarid, preview, resource, 'video');\n                return controlbar;\n            },\n            //insert the control bar and return it to be reused\n            insert_controlbar_audio: function (element, controlbarid, preview, resource) {\n                var controlbar = this.prepare_controlbar(element, controlbarid, preview, resource, 'audio');\n                return controlbar;\n            },\n\n            //insert the control bar and return it to be reused\n            prepare_controlbar: function (element, controlbarid, preview, resource, mediatype) {\n                var ip = this.fetch_instanceprops();\n                var skin_style = ip.config.media_skin_style;\n\n                var recorder_class = mediatype == 'video' ? 'poodll_mediarecorder_video' : 'poodll_mediarecorder_audio';\n                var size_class = 'poodll_mediarecorder_size_auto';\n\n                var ss = this.pmr.fetch_strings();\n                var ss_startlabel = ss['recui_record'];\n                var ss_testlabel = ss['recui_testmic'];\n                var ss_stoplabel = ss['recui_stop'];\n\n                var status = this.fetch_status_bar('once');\n                var controls = '<div class=\"poodll_mediarecorderholder_once '\n                    + recorder_class + '\" id=\"holder_' + controlbarid + '\">';\n\n                controls += '<div class=\"poodll_mediarecorderbox_once\" id=\"' + controlbarid + '\">';\n                controls += this.devsettings.fetch_dialogue_box();\n                controls += ip.downloaddialog.fetch_dialogue_box();\n                controls += ip.errordialog.fetch_dialogue_box();\n                controls += '<div class=\"style-holder ' + skin_style + '\">';\n                controls += preview,\n                    controls += '<div class=\"settingsicon\" id=\"settingsicon_' + controlbarid + '\"><button type=\"button\" class=\"btn-poodllsettings\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>';\n                controls += '<canvas id=\"' + controlbarid + '_playcanvas\" width=\"250\" height=\"50\" class=\"poodll_mediarecorder_playcanvas_once\"></canvas>';\n                controls += status,\n                    controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_once poodll_start-recording_once\">' + ss_startlabel + '</button>';\n                controls += '<button type=\"button\" class=\"poodll_mediarecorder_button_once poodll_stop-recording_once\">' + ss_stoplabel + '</button>';\n                if (mediatype == 'audio') {\n                    controls += '<canvas id=\"' + controlbarid + '_uploadcanvas\" width=\"250\" height=\"50\" class=\"poodll_mediarecorder_uploadcanvas_once\"></canvas>';\n                } else {\n                    //we keep the canvas same height as video, but narrowe so the radial stays under the timer (we center it with CSS)\n                    controls += '<canvas id=\"' + controlbarid + '_uploadcanvas\" width=\"130\" height=\"210\" class=\"poodll_mediarecorder_uploadcanvas_once\"></canvas>';\n                }\n\n                controls += '<div class=\"poodll_uploadmessages_once\"></div>';\n\n                controls += '</div></div></div>';\n                $(element).prepend(controls);\n                //<i class=\"fa fa-stop\" aria-hidden=\"true\"></i>\n                var controlbar = {\n                    settingsdialog: $('#' + controlbarid + ' .poodll_dialogue_box_settings'),\n                    downloaddialog: $('#' + controlbarid + ' .poodll_dialogue_box_download'),\n                    errorsdialog: $('#' + controlbarid + ' .poodll_dialogue_box_errors'),\n                    settingsicon: $('#' + controlbarid + ' .settingsicon'),\n                    status: $('#' + controlbarid + ' .poodll_status_once'),\n                    preview: $('#' + controlbarid + ' .poodll_preview_once'),\n                    startbutton: $('#' + controlbarid + ' .poodll_start-recording_once'),\n                    stopbutton: $('#' + controlbarid + ' .poodll_stop-recording_once'),\n                    playcanvas: $('#' + controlbarid + '_playcanvas'),\n                    uploadcanvas: $('#' + controlbarid + '_uploadcanvas'),\n                    uploadmessages: $('#' + controlbarid + ' .poodll_uploadmessages_once')\n                };\n                //settings and error and download dialogs\n                //settings is on 'this' because it is shown from skkn events, but errors are from pmr stuff\n                ip.downloaddialog.set_dialogue_box(controlbar.downloaddialog);\n                ip.errordialog.set_dialogue_box(controlbar.errorsdialog);\n                this.devsettings.set_dialogue_box(controlbar.settingsdialog);\n\n                return controlbar;\n            }, //end of fetch_control_bar_once\n\n\n            register_controlbar_events_video: function (onMediaSuccess, controlbarid) {\n                return this.register_controlbar_events_audio(onMediaSuccess, controlbarid);\n            },\n\n            register_controlbar_events_audio: function (onMediaSuccess, controlbarid) {\n\n                var self = this;\n                var pmr = this.pmr;\n                var ip = this.fetch_instanceprops();\n\n                //init recording anim\n                ip.config.recanim = 'hwave_mic';\n                var recanim = hwave.clone();\n                self.therecanim = recanim;\n                recanim.init(ip.audioanalyser, ip.controlbar.playcanvas.get(0));\n\n                //set visual mode\n                this.set_visual_mode('readymode', controlbarid);\n\n\n                ip.controlbar.settingsicon.click(function () {\n                    if (!self.uploaded) {\n                        self.devsettings.open();\n                    } else {\n                        ip.downloaddialog.open();\n                    }\n                });\n\n                //Start button click\n                ip.controlbar.startbutton.click(function () {\n                    //we start real recording here.\n                    // so we enable messages to API client and timer\n                    ip.config.hermes.enable();\n                    ip.timer.enable();\n                    pmr.do_start_audio(ip, onMediaSuccess);\n                });\n\n\n                //Stop button click\n                ip.controlbar.stopbutton.click(function () {\n\n                    //stop recording\n                    pmr.do_stop_audio(ip);\n\n                    //wave animation\n                    recanim.clear();\n\n                    //timer and status bar\n                    ip.timer.stop();\n                    self.update_status(controlbarid);\n\n                    //call upload right away\n                    //but we have to do it this lame deferred way because some mediastreamrecorders return a single\n                    //blob shortly after we stop. We init like that too, to make sure we do not truncate a users recording\n                    //if the mini blobs did not arrive\n                    var doDeferredUpload = function () {\n                        if (ip.blobs && ip.blobs.length > 0) {\n                            pmr.do_save_audio(ip);\n                            ip.uploaded = true;\n                            self.disable_button(ip.controlbar.startbutton);\n                        } else {\n                            setTimeout(doDeferredUpload, 200);\n                        }\n                    }\n                    setTimeout(doDeferredUpload, 200);\n\n                    //set visuals\n                    self.set_visual_mode('aftermode', controlbarid);\n\n                });\n\n\n                window.onbeforeunload = function () {\n                    //no need to do anything here\n                    // self.enable_button(ip.controlbar.startbutton);\n\n                };\n            }, //end of register_control_bar_events_once\n\n\n            enable_button: function (button) {\n                $(button).attr('disabled', false);\n                $(button).removeClass('pmr_disabled');\n            },\n            disable_button: function (button) {\n                $(button).attr('disabled', true);\n                $(button).addClass('pmr_disabled');\n            },\n\n        };//end of returned object\n    });//total end\n"],"file":"poodll_oncemediaskin.min.js"}