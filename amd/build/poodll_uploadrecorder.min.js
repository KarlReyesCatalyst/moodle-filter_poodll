define(["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";return b.debug("PoodLL upload Recorder: initialising"),{config:null,supports_current_browser:function(){return!0},embed:function(a,b){this.config=b,this.insert_controls(a),c.init(a,b),this.register_events()},insert_controls:function(c){var d="";b.debug("and config ha");var e=this.config;switch(e.mediatype){case"audio":default:d="audio"}b.debug("got to insert controls");var f='<div class="p_btn_wrapper">';f+='<input type="file" id="'+e.widgetid+'_poodllfileselect" name="poodllfileselect[]" '+d+"/>",f+='<button type="button" class="p_btn">Record Now</button>',f+="</div>",a(c).prepend(f),b.debug("got to insert controls:prepend")},register_events:function(){var b=this,c=this.config;a("#"+c.widgetid+"_poodllfileselect").on("change",function(a){b.FileSelectHandler(a)})},FileSelectHandler:function(a){for(var b,d=a.target.files||a.dataTransfer.files,e=0;b=d[e];e++)c.uploadBlob(b,b.type)},ParseFile:function(a){var b="",d=new FileReader;d.onloadend=function(d){b=d.target.result,c.uploadFile(b,a.type)},d.readAsDataURL(a)}}});