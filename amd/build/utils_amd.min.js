define(["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";return b.debug("Filter PoodLL: utils initialising"),{whiteboards:[],whiteboardopts:[],timeouthandles:[],WhiteboardUploadHandler:function(a){var b=this.getbyid(a+"_btn_upload_whiteboard");b.disabled=!0,clearTimeout(this.timeouthandle),this.CallFileUpload(a)},CallFileUpload:function(a){var b=this.whiteboards[a],d=null,e="";if(0==a.indexOf("drawingboard_")){d=b.canvas;var e=JSON.stringify(b.history,null,2)}else{d=this.whiteboardopts[a].bgimage?b.canvasWithBackground(this.getbyid(a+"_separate-background-image")):b.getImage({});var e=JSON.stringify(b.getSnapshot())}if(this.whiteboardopts[a].vectorcontrol){var f=this.getbyid(this.whiteboardopts[a].vectorcontrol);f&&(f.value=e)}var g=d.toDataURL().split(",")[1],h={type:"image/png"};c.UploadFile(h,g,a,this.whiteboardopts[a])},getbyid:function(b){b="#"+b.replace(/(:|\.|\[|\]|,)/g,"\\$1");var c=a(b);return c&&c.length>0?c[0]:(c=a(b,window.parent.document),c&&c.length>0?c[0]:null)},executeFunctionByName:function(a,b,c){for(var d=a.split("."),e=d.pop(),f=0;f<d.length;f++)b=b[d[f]];return b[e].call(this,c)}}});